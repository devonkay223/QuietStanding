<!doctype html>
<html lang=en>
  <head>
    <meta charset='utf-8'>
    <script src='gen.lib.js'></script>
  </head>
  <body>
    <p style="width:25em;" > 
    <span style="font-weight:bold">Click/touch in the page to begin</span>. 
    This example shows how you can use the "input" ugen to plug regular Web Audio API 
    nodes into a AudioWorklet node created by genish.js. 
    If you open your developer's console, you should see the generated callback function. 
    </p>
  </body>
  <script>

    const click = function() {
      console.log("touch start recognized")
      const ctx = utilities.ctx

      // create a WAAPI oscillator
      const sine = ctx.createOscillator()
      sine.frequency.value = 2

      // use this gain to scale the output of our oscillator
      const gain  = ctx.createGain()
      gain.gain.value = 40

      sine.connect( gain )

      utilities.playWorklet( 
        cycle( add( 220, input('freqMod', 0, 0 ) ) ), 
        'test', // this name isn't really important
        true    // print generated code to developers console
      ).then( node => {
        gain.connect( node )
        sine.start()

        console.log( 'playing...' )
      })

      window.removeEventListener( 'touchstart', click )
    }

    window.onload = ()=> {
      window.addEventListener( 'touchstart', click )
      window.addEventListener( 'click', click )

      genish.export( window )

      // audio context will be stored in utilities.ctx
      utilities.createContext()
    }

  </script>
</html>

<!-- <!doctype html>
    <head>
        <title>QuietStanding</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/p5.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/addons/p5.sound.min.js"></script>
        <script src="gen.lib.js"></script>
        <link href="https://fonts.googleapis.com/css?family=Rubik" rel="stylesheet">
        <link rel="stylesheet" href="style.css" type="text/css">
    </head>
<body>
    <h1>Quiet Standing</h1>
    <button id="accelPermsButton"  style="height:50px;" onclick="getPerm()"><h2>Get Accelerometer Permissions</h2></button>
    <button id="accelPermsButton"  style="height:50px;" onclick="audio()"><h2>Audio</h2></button>
    <script  type="text/javascript" src="Motion.js"></script>
</body>
</html> -->